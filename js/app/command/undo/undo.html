<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>撤销命令</title>
	</head>
	<body>
		<button id="replay"> 我是一个小button
		</button>
	</body>
	<script>
		var Act = {
			attack :function() {
				
			},
			defense:function() {
				
			},
			jump:function(){
				
			},
			crouch:function() {
				
			}
		};
		var makeCommand = function(receiver,state) {
			return function() {
				receiver[state];
			}
		};
		var commands = {
			"119":"jump",
			"115":"crouch",
			"97":"defense",
			"100":"attack"
		};
		var commandStack = [];
		document.onkeypress = function(ev){
			var keyCode = ev.keyCode,
				command = makeCommand(Act,commands[keyCode]);
			
			if(command){
				command();
				commandStack.push(command);
			}
		};
		
		document.getElementById('replay').onclick = function() {
			var command ;
			while(command = commandStack.shift()){
				command();
			}
		}
	</script>
</html>
